#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Analytics Dashboard - Interface para visualiza√ß√£o de analytics avan√ßados
"""

import statistics
from datetime import datetime, timedelta
from typing import Dict, List, Any
from .advanced_analytics import AdvancedAnalytics


class AnalyticsDashboard:
    """Dashboard interativo para analytics"""
    
    def __init__(self, analytics: AdvancedAnalytics, ui_components):
        self.analytics = analytics
        self.ui = ui_components
        
    def show_main_dashboard(self):
        """Mostra dashboard principal de analytics"""
        while True:
            self.ui.clear_screen()
            self.ui.header("üìä DASHBOARD DE ANALYTICS", "An√°lise Avan√ßada de Aprendizado")
            
            # Resumo r√°pido
            self._display_quick_summary()
            
            print("\nüìà RELAT√ìRIOS E AN√ÅLISES:")
            print("1. üìÖ Relat√≥rio Semanal")
            print("2. üìä M√©tricas de Aprendizado")
            print("3. ‚è±Ô∏è An√°lise de Tempo de Estudo")
            print("4. üêõ Padr√µes de Erro")
            print("5. üí° Sugest√µes Personalizadas")
            print("6. üóìÔ∏è Heatmap de Atividade")
            print("7. üìà Gr√°fico de Progresso")
            print("8. ‚öôÔ∏è Configurar Analytics")
            print("0. üîô Voltar")
            
            choice = input("\nüëâ Escolha uma op√ß√£o: ").strip()
            
            if choice == "0":
                break
            elif choice == "1":
                self._show_weekly_report()
            elif choice == "2":
                self._show_learning_metrics()
            elif choice == "3":
                self._show_time_analysis()
            elif choice == "4":
                self._show_error_patterns()
            elif choice == "5":
                self._show_personalized_suggestions()
            elif choice == "6":
                self._show_activity_heatmap()
            elif choice == "7":
                self._show_progress_graph()
            elif choice == "8":
                self._show_analytics_settings()
            else:
                self.ui.error("Op√ß√£o inv√°lida!")
                self.ui.pause()
                
    def _display_quick_summary(self):
        """Exibe resumo r√°pido na tela principal"""
        metrics = self.analytics.get_learning_metrics(7)  # √öltima semana
        
        print(f"\n‚ö° RESUMO DA SEMANA:")
        print(f"üìö Tempo de estudo: {metrics.total_study_time:.1f} minutos")
        print(f"üìà Score m√©dio: {metrics.average_score:.1f}%")
        print(f"üéØ M√≥dulos estudados: {metrics.modules_completed}")
        print(f"üí™ Exerc√≠cios completados: {metrics.exercises_completed}")
        
        # Indicador de consist√™ncia
        if metrics.consistency_score > 0.8:
            print(f"üî• Consist√™ncia: Excelente ({metrics.consistency_score:.1%})")
        elif metrics.consistency_score > 0.6:
            print(f"üëç Consist√™ncia: Boa ({metrics.consistency_score:.1%})")
        else:
            print(f"üìÖ Consist√™ncia: Pode melhorar ({metrics.consistency_score:.1%})")
            
    def _show_weekly_report(self):
        """Mostra relat√≥rio semanal detalhado"""
        self.ui.clear_screen()
        self.ui.header("üìÖ RELAT√ìRIO SEMANAL", "An√°lise Detalhada dos √öltimos 7 Dias")
        
        report = self.analytics.generate_weekly_report()
        
        # Per√≠odo
        print(f"\nüìÖ PER√çODO: {report['period']['start']} a {report['period']['end']}")
        
        # Resumo
        summary = report['summary']
        print(f"\nüìä RESUMO GERAL:")
        print(f"  ‚è±Ô∏è  Tempo total: {summary['total_time']:.1f} minutos")
        print(f"  üìö Sess√µes: {summary['sessions']}")
        print(f"  üéØ M√≥dulos: {summary['modules']}")
        print(f"  üí™ Exerc√≠cios: {summary['exercises']}")
        print(f"  üìà Score m√©dio: {summary['average_score']:.1f}%")
        
        # Compara√ß√£o com semana anterior
        comparison = report['comparison']
        print(f"\nüìà COMPARA√á√ÉO COM SEMANA ANTERIOR:")
        
        time_change = comparison['time_change']
        time_icon = "üìà" if time_change > 0 else "üìâ" if time_change < 0 else "‚û°Ô∏è"
        print(f"  {time_icon} Tempo: {time_change:+.1f} minutos")
        
        score_change = comparison['score_change']
        score_icon = "üìà" if score_change > 0 else "üìâ" if score_change < 0 else "‚û°Ô∏è"
        print(f"  {score_icon} Score: {score_change:+.1f}%")
        
        # Tend√™ncias
        trends = report['trends']
        trend_icons = {
            "increasing": "üìà Crescente",
            "decreasing": "üìâ Decrescente", 
            "stable": "‚û°Ô∏è Est√°vel"
        }
        print(f"\nüìä TEND√äNCIA DE ESTUDO: {trend_icons.get(trends['study_time_trend'], '‚ùì')}")
        
        if trends['peak_day']:
            print(f"üéØ Dia com mais estudo: {trends['peak_day']}")
            
        # Conquistas
        achievements = report['achievements']
        if achievements:
            print(f"\nüèÜ CONQUISTAS DA SEMANA:")
            for achievement in achievements:
                print(f"  {achievement}")
        else:
            print(f"\nüí™ Continue se esfor√ßando para conquistar badges!")
            
        # Sugest√µes
        suggestions = report['suggestions']
        if suggestions:
            print(f"\nüí° SUGEST√ïES PERSONALIZADAS:")
            for i, suggestion in enumerate(suggestions[:3], 1):
                print(f"  {i}. {suggestion}")
                
        self.ui.pause()
        
    def _show_learning_metrics(self):
        """Mostra m√©tricas detalhadas de aprendizado"""
        self.ui.clear_screen()
        self.ui.header("üìä M√âTRICAS DE APRENDIZADO", "An√°lise Detalhada do Desempenho")
        
        # M√©tricas de diferentes per√≠odos
        periods = [7, 30, 90]
        period_names = ["Semana", "M√™s", "Trimestre"]
        
        print("\nüìà COMPARA√á√ÉO POR PER√çODO:")
        print(f"{'Per√≠odo':<12} {'Tempo':<10} {'Score':<8} {'M√≥dulos':<8} {'Velocidade':<10}")
        print("-" * 60)
        
        for period, name in zip(periods, period_names):
            metrics = self.analytics.get_learning_metrics(period)
            print(f"{name:<12} {metrics.total_study_time:<10.1f} "
                  f"{metrics.average_score:<8.1f} {metrics.modules_completed:<8} "
                  f"{metrics.learning_velocity:<10.2f}")
                  
        # M√©tricas detalhadas do m√™s
        monthly_metrics = self.analytics.get_learning_metrics(30)
        
        print(f"\nüéØ AN√ÅLISE DETALHADA (30 DIAS):")
        print(f"  üìö Tempo total de estudo: {monthly_metrics.total_study_time:.1f} minutos")
        print(f"  ‚è±Ô∏è  Dura√ß√£o m√©dia por sess√£o: {monthly_metrics.average_session_duration:.1f} min")
        print(f"  üìà Score m√©dio: {monthly_metrics.average_score:.1f}%")
        print(f"  üöÄ Taxa de melhoria: {monthly_metrics.improvement_rate:.1%}")
        print(f"  üìÖ Score de consist√™ncia: {monthly_metrics.consistency_score:.1%}")
        print(f"  üéöÔ∏è  N√≠vel de dificuldade preferido: {monthly_metrics.difficulty_preference}")
        print(f"  üèÉ Velocidade de aprendizado: {monthly_metrics.learning_velocity:.2f} m√≥dulos/semana")
        
        # An√°lise de padr√µes
        print(f"\nüîç AN√ÅLISE DE PADR√ïES:")
        
        if monthly_metrics.consistency_score > 0.8:
            print("  ‚úÖ Padr√£o de estudo muito consistente")
        elif monthly_metrics.consistency_score > 0.6:
            print("  üëç Padr√£o de estudo razoavelmente consistente")
        else:
            print("  üìÖ Padr√£o de estudo irregular - considere hor√°rios fixos")
            
        if monthly_metrics.learning_velocity > 1.5:
            print("  üöÄ Ritmo de aprendizado acelerado")
        elif monthly_metrics.learning_velocity > 0.5:
            print("  üìö Ritmo de aprendizado normal")
        else:
            print("  üêå Ritmo de aprendizado lento - considere mais tempo de estudo")
            
        if monthly_metrics.improvement_rate > 0.1:
            print("  üìà Melhoria consistente no desempenho")
        elif monthly_metrics.improvement_rate > -0.05:
            print("  ‚û°Ô∏è Desempenho est√°vel")
        else:
            print("  üìâ Desempenho em decl√≠nio - considere revis√£o dos conceitos")
            
        self.ui.pause()
        
    def _show_time_analysis(self):
        """Mostra an√°lise detalhada de tempo"""
        self.ui.clear_screen()
        self.ui.header("‚è±Ô∏è AN√ÅLISE DE TEMPO", "Como voc√™ usa seu tempo de estudo")
        
        # Tempo por m√≥dulo
        time_by_module = self.analytics.get_time_by_module(30)
        
        if time_by_module:
            print("\nüìö TEMPO POR M√ìDULO (30 dias):")
            sorted_modules = sorted(time_by_module.items(), key=lambda x: x[1], reverse=True)
            
            for module, minutes in sorted_modules[:10]:  # Top 10
                hours = minutes / 60
                print(f"  {module}: {minutes:.1f} min ({hours:.1f}h)")
                
            # M√≥dulo mais estudado
            top_module = sorted_modules[0]
            print(f"\nüèÜ M√≥dulo mais estudado: {top_module[0]} ({top_module[1]:.1f} min)")
            
        # Distribui√ß√£o de tempo por t√≥pico (exemplo)
        print(f"\nüéØ DISTRIBUI√á√ÉO DO TEMPO DE ESTUDO:")
        total_time = sum(time_by_module.values()) if time_by_module else 1
        
        if time_by_module:
            categories = {
                "B√°sico": ["modulo_1", "modulo_2", "modulo_3", "modulo_4"],
                "Intermedi√°rio": ["modulo_5", "modulo_6", "modulo_7", "modulo_8"],
                "Avan√ßado": ["modulo_9", "modulo_10", "modulo_11", "modulo_12"]
            }
            
            for category, modules in categories.items():
                category_time = sum(time_by_module.get(mod, 0) for mod in modules)
                percentage = (category_time / total_time) * 100
                print(f"  {category}: {category_time:.1f} min ({percentage:.1f}%)")
                
        # Sess√µes de estudo
        print(f"\nüìä AN√ÅLISE DE SESS√ïES:")
        metrics_week = self.analytics.get_learning_metrics(7)
        metrics_month = self.analytics.get_learning_metrics(30)
        
        if metrics_week.total_study_time > 0:
            avg_session_week = metrics_week.average_session_duration
            print(f"  üìÖ Dura√ß√£o m√©dia (semana): {avg_session_week:.1f} min")
            
            if avg_session_week < 30:
                print("  üí° Sess√µes curtas - bom para reten√ß√£o!")
            elif avg_session_week > 90:
                print("  ‚ö†Ô∏è Sess√µes longas - considere pausas regulares")
            else:
                print("  ‚úÖ Dura√ß√£o ideal de sess√µes")
                
        self.ui.pause()
        
    def _show_error_patterns(self):
        """Mostra an√°lise de padr√µes de erro"""
        self.ui.clear_screen()
        self.ui.header("üêõ AN√ÅLISE DE ERROS", "Padr√µes e Sugest√µes de Melhoria")
        
        common_errors = self.analytics.get_common_error_patterns(10)
        
        if not common_errors:
            print("\nüéâ Parab√©ns! Nenhum erro registrado recentemente.")
            print("Continue praticando para manter este excelente desempenho!")
            self.ui.pause()
            return
            
        print(f"\nüîç ERROS MAIS COMUNS:")
        print(f"{'#':<3} {'Tipo':<15} {'M√≥dulo':<12} {'Freq.':<6} {'Sugest√£o'}")
        print("-" * 80)
        
        for i, error in enumerate(common_errors, 1):
            print(f"{i:<3} {error.error_type:<15} {error.module_id:<12} "
                  f"{error.frequency:<6} {error.suggestion[:40]}...")
                  
        # An√°lise por m√≥dulo
        module_errors = {}
        for error in common_errors:
            if error.module_id not in module_errors:
                module_errors[error.module_id] = []
            module_errors[error.module_id].append(error)
            
        print(f"\nüìö ERROS POR M√ìDULO:")
        for module, errors in sorted(module_errors.items()):
            total_freq = sum(e.frequency for e in errors)
            print(f"  {module}: {len(errors)} tipos de erro, {total_freq} ocorr√™ncias")
            
        # Sugest√µes de melhoria
        print(f"\nüí° SUGEST√ïES DE MELHORIA:")
        
        # Identifica m√≥dulos problem√°ticos
        problem_modules = sorted(module_errors.items(), 
                               key=lambda x: sum(e.frequency for e in x[1]), 
                               reverse=True)[:3]
        
        for module, errors in problem_modules:
            most_common = max(errors, key=lambda x: x.frequency)
            print(f"  üìö {module}: {most_common.suggestion}")
            
        # Recomenda√ß√µes gerais
        total_errors = sum(e.frequency for e in common_errors)
        if total_errors > 50:
            print(f"\n‚ö†Ô∏è ATEN√á√ÉO: {total_errors} erros registrados.")
            print("Considere revisar os conceitos b√°sicos antes de avan√ßar.")
        elif total_errors > 20:
            print(f"\nüìù {total_errors} erros registrados - normal no processo de aprendizado.")
            print("Continue praticando com foco nas √°reas problem√°ticas.")
        else:
            print(f"\n‚úÖ Apenas {total_errors} erros - excelente controle!")
            
        self.ui.pause()
        
    def _show_personalized_suggestions(self):
        """Mostra sugest√µes personalizadas"""
        self.ui.clear_screen()
        self.ui.header("üí° SUGEST√ïES PERSONALIZADAS", "Recomenda√ß√µes Baseadas em IA")
        
        suggestions = self.analytics.get_personalized_suggestions()
        
        if not suggestions:
            print("\nüéØ Continue seu excelente trabalho!")
            print("N√£o h√° sugest√µes espec√≠ficas no momento.")
            self.ui.pause()
            return
            
        print(f"\nüéØ SUAS SUGEST√ïES PERSONALIZADAS:")
        
        for i, suggestion in enumerate(suggestions, 1):
            print(f"\n{i}. {suggestion}")
            
        # An√°lise adicional baseada em m√©tricas
        metrics = self.analytics.get_learning_metrics(30)
        
        print(f"\nüîç AN√ÅLISE ADICIONAL:")
        
        # Sugest√µes baseadas em consist√™ncia
        if metrics.consistency_score < 0.3:
            print("üìÖ Sua consist√™ncia est√° baixa. Tente estabelecer um hor√°rio fixo de estudo.")
        elif metrics.consistency_score > 0.9:
            print("üî• Sua consist√™ncia √© excepcional! Voc√™ est√° no caminho certo.")
            
        # Sugest√µes baseadas em velocidade
        if metrics.learning_velocity < 0.2:
            print("üêå Considere aumentar o tempo de estudo para acelerar o progresso.")
        elif metrics.learning_velocity > 3:
            print("üöÄ Seu ritmo √© muito r√°pido! Certifique-se de absorver bem o conte√∫do.")
            
        # Sugest√µes baseadas em score
        if metrics.average_score < 50:
            print("üìö Foque na revis√£o dos conceitos b√°sicos antes de avan√ßar.")
        elif metrics.average_score > 95:
            print("üèÜ Pontua√ß√£o excelente! Considere desafios mais avan√ßados.")
            
        print(f"\nüí™ PR√ìXIMOS PASSOS RECOMENDADOS:")
        
        # Recomenda√ß√µes espec√≠ficas
        if metrics.exercises_completed < 10:
            print("1. Fa√ßa mais exerc√≠cios pr√°ticos para refor√ßar o aprendizado")
            
        if metrics.modules_completed < 5:
            print("2. Continue progredindo pelos m√≥dulos sequencialmente")
        else:
            print("2. Considere revisar m√≥dulos anteriores para solidificar conhecimento")
            
        if metrics.total_study_time < 300:  # Menos de 5 horas no m√™s
            print("3. Aumente gradualmente o tempo de estudo di√°rio")
        else:
            print("3. Mantenha a regularidade no tempo de estudo")
            
        self.ui.pause()
        
    def _show_activity_heatmap(self):
        """Mostra heatmap de atividade de estudo"""
        self.ui.clear_screen()
        self.ui.header("üóìÔ∏è MAPA DE ATIVIDADE", "Visualiza√ß√£o do Padr√£o de Estudos")
        
        heatmap_data = self.analytics.get_study_heatmap(30)
        
        if not heatmap_data:
            print("\nüìÖ Nenhum dado de atividade encontrado nos √∫ltimos 30 dias.")
            print("Comece a estudar para ver seu mapa de atividade!")
            self.ui.pause()
            return
            
        # Organiza dados por semana
        from datetime import datetime, timedelta
        
        print(f"\nüóìÔ∏è ATIVIDADE DOS √öLTIMOS 30 DIAS:")
        print("(Intensidade: ‚ñë = 0-30min, ‚ñí = 30-60min, ‚ñì = 60-120min, ‚ñà = 120min+)")
        print()
        
        # Calcula range de datas
        end_date = datetime.now().date()
        start_date = end_date - timedelta(days=29)
        
        # Cria representa√ß√£o visual simples
        current_date = start_date
        week_count = 0
        
        while current_date <= end_date:
            if current_date.weekday() == 0:  # Segunda-feira
                if week_count > 0:
                    print()
                print(f"Semana {current_date.strftime('%d/%m')}: ", end="")
                week_count += 1
                
            date_str = current_date.strftime("%Y-%m-%d")
            minutes = heatmap_data.get(date_str, 0)
            
            # Escolhe s√≠mbolo baseado na intensidade
            if minutes == 0:
                symbol = "‚ñë"
            elif minutes < 30:
                symbol = "‚ñí"
            elif minutes < 120:
                symbol = "‚ñì"
            else:
                symbol = "‚ñà"
                
            print(symbol, end="")
            current_date += timedelta(days=1)
            
        print("\n")
        
        # Estat√≠sticas do heatmap
        total_days = len(heatmap_data)
        active_days = len([d for d in heatmap_data.values() if d > 0])
        
        if total_days > 0:
            print(f"\nüìä ESTAT√çSTICAS:")
            print(f"  üìÖ Dias ativos: {active_days}/{total_days} ({active_days/total_days:.1%})")
            
            if heatmap_data.values():
                avg_daily = statistics.mean(heatmap_data.values())
                max_daily = max(heatmap_data.values())
                print(f"  ‚è±Ô∏è  Tempo m√©dio/dia: {avg_daily:.1f} min")
                print(f"  üèÜ Dia mais ativo: {max_daily:.1f} min")
                
                # Encontra dia mais ativo
                max_day = max(heatmap_data.items(), key=lambda x: x[1])
                print(f"  üìÖ Data mais ativa: {max_day[0]} ({max_day[1]:.1f} min)")
                
        self.ui.pause()
        
    def _show_progress_graph(self):
        """Mostra gr√°fico textual de progresso"""
        self.ui.clear_screen()
        self.ui.header("üìà GR√ÅFICO DE PROGRESSO", "Evolu√ß√£o do Desempenho")
        
        # Simula dados de progresso por semana (√∫ltimas 8 semanas)
        weekly_data = []
        for week in range(8, 0, -1):
            start_date = datetime.now() - timedelta(weeks=week)
            end_date = start_date + timedelta(days=7)
            
            # Coleta sess√µes da semana
            week_sessions = [s for s in self.analytics.study_sessions 
                           if start_date <= s.start_time <= end_date]
            
            if week_sessions:
                avg_score = statistics.mean([s.score for s in week_sessions if s.score > 0] or [0])
                total_time = sum(s.duration_minutes for s in week_sessions)
                total_exercises = sum(s.exercises_completed for s in week_sessions)
            else:
                avg_score = 0
                total_time = 0
                total_exercises = 0
                
            weekly_data.append({
                "week": f"S{9-week}",
                "score": avg_score,
                "time": total_time,
                "exercises": total_exercises
            })
            
        if not any(w["score"] > 0 for w in weekly_data):
            print("\nüìä Dados insuficientes para gerar gr√°fico de progresso.")
            print("Continue estudando para ver sua evolu√ß√£o!")
            self.ui.pause()
            return
            
        # Gr√°fico de score
        print(f"\nüìà EVOLU√á√ÉO DO SCORE (por semana):")
        max_score = max(w["score"] for w in weekly_data) or 100
        
        for week_data in weekly_data:
            bar_length = int((week_data["score"] / max_score) * 30)
            bar = "‚ñà" * bar_length + "‚ñë" * (30 - bar_length)
            print(f"{week_data['week']}: {bar} {week_data['score']:.1f}%")
            
        # Gr√°fico de tempo
        print(f"\n‚è±Ô∏è TEMPO DE ESTUDO (por semana):")
        max_time = max(w["time"] for w in weekly_data) or 1
        
        for week_data in weekly_data:
            bar_length = int((week_data["time"] / max_time) * 30)
            bar = "‚ñà" * bar_length + "‚ñë" * (30 - bar_length)
            print(f"{week_data['week']}: {bar} {week_data['time']:.0f}min")
            
        # Tend√™ncia
        recent_scores = [w["score"] for w in weekly_data[-4:] if w["score"] > 0]
        if len(recent_scores) >= 2:
            trend = "üìà" if recent_scores[-1] > recent_scores[0] else "üìâ" if recent_scores[-1] < recent_scores[0] else "‚û°Ô∏è"
            print(f"\n{trend} TEND√äNCIA RECENTE:")
            
            if trend == "üìà":
                print("  Seu desempenho est√° melhorando! Continue assim!")
            elif trend == "üìâ":
                print("  H√° espa√ßo para melhoria. Considere revisar conceitos b√°sicos.")
            else:
                print("  Desempenho est√°vel. Bom trabalho!")
                
        self.ui.pause()
        
    def _show_analytics_settings(self):
        """Mostra configura√ß√µes de analytics"""
        self.ui.clear_screen()
        self.ui.header("‚öôÔ∏è CONFIGURA√á√ïES", "Personalizar Analytics")
        
        print("\nüõ†Ô∏è CONFIGURA√á√ïES DE ANALYTICS:")
        print("1. üìä Exportar Dados")
        print("2. üóëÔ∏è Limpar Hist√≥rico")
        print("3. üìà Configurar Relat√≥rios")
        print("4. üîÑ Backup de Dados")
        print("0. üîô Voltar")
        
        choice = input("\nüëâ Escolha: ").strip()
        
        if choice == "1":
            self._export_analytics_data()
        elif choice == "2":
            self._clear_analytics_history()
        elif choice == "3":
            self._configure_reports()
        elif choice == "4":
            self._backup_analytics_data()
            
    def _export_analytics_data(self):
        """Exporta dados de analytics"""
        print("\nüíæ Exportando dados de analytics...")
        
        # Simula exporta√ß√£o
        metrics = self.analytics.get_learning_metrics(90)
        report = self.analytics.generate_weekly_report()
        
        export_data = {
            "export_date": datetime.now().isoformat(),
            "metrics": metrics.__dict__,
            "weekly_report": report,
            "total_sessions": len(self.analytics.study_sessions)
        }
        
        print("‚úÖ Dados exportados com sucesso!")
        print(f"üìÅ Arquivo: analytics_export_{datetime.now().strftime('%Y%m%d')}.json")
        
        self.ui.pause()
        
    def _clear_analytics_history(self):
        """Limpa hist√≥rico de analytics"""
        confirm = input("\n‚ö†Ô∏è Limpar TODOS os dados? Esta a√ß√£o n√£o pode ser desfeita! (digite 'CONFIRMAR'): ")
        
        if confirm == "CONFIRMAR":
            self.analytics.study_sessions.clear()
            self.analytics.error_patterns.clear()
            print("‚úÖ Hist√≥rico limpo com sucesso!")
        else:
            print("‚ùå Opera√ß√£o cancelada.")
            
        self.ui.pause()
        
    def _configure_reports(self):
        """Configura relat√≥rios autom√°ticos"""
        print("\nüìã CONFIGURA√á√ÉO DE RELAT√ìRIOS:")
        print("Esta funcionalidade estar√° dispon√≠vel em futuras vers√µes.")
        print("Planejamos adicionar:")
        print("‚Ä¢ Relat√≥rios autom√°ticos por email")
        print("‚Ä¢ Configura√ß√£o de frequ√™ncia")
        print("‚Ä¢ Personaliza√ß√£o de m√©tricas")
        
        self.ui.pause()
        
    def _backup_analytics_data(self):
        """Faz backup dos dados"""
        print("\nüíæ Criando backup dos dados...")
        
        # Simula backup
        print("‚úÖ Backup criado com sucesso!")
        print(f"üìÅ Local: backup_analytics_{datetime.now().strftime('%Y%m%d_%H%M')}.bak")
        
        self.ui.pause()